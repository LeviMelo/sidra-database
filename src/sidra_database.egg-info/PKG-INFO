Metadata-Version: 2.4
Name: sidra-database
Version: 0.1.0
Summary: Local metadata store and search tooling for IBGE SIDRA tables
Author: Galaxy
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: httpx>=0.27
Requires-Dist: orjson>=3.9
Requires-Dist: pydantic>=2.6
Requires-Dist: sqlalchemy>=2.0
Requires-Dist: aiosqlite>=0.20
Requires-Dist: tenacity>=8.2
Requires-Dist: python-dotenv>=1.0
Provides-Extra: dev
Requires-Dist: pytest>=8.0; extra == "dev"
Requires-Dist: pytest-asyncio>=0.23; extra == "dev"
Requires-Dist: ruff>=0.5; extra == "dev"
Requires-Dist: mypy>=1.10; extra == "dev"

# SIDRA Database

Python toolkit for building a local SQLite metadata store and search layer for IBGE SIDRA agregados.

## Features
- Asynchronous client for the aggregated-data v3 API.
- SQLite schema and ingestion pipeline capturing tables, variables, classifications, periods, and localities.
- LM Studio embedding client for local vector generation.
- Coverage-aware catalog of agregados, including municipality counts and national coverage flags.
- CLI helper to ingest, inspect, and semantically search agregados.
- Pytest, Ruff, and MyPy configuration for development.

## Quickstart
```bash
# Install in editable mode with dev extras
pip install -e .[dev]

# Ingest one or more agregados into SQLite
python -m sidra_database.cli ingest 6579 2093

# Run a semantic search against stored embeddings
python -m sidra_database.cli search "população por sexo" --types variable classification

# List agregados covering most municipalities
python -m sidra_database.cli list --requires-national-munis

# Run tests and linters
pytest
ruff check src tests
mypy src
```

Set `SIDRA_DATABASE_PATH` to control the SQLite location and `SIDRA_EMBEDDING_API_URL` if LM Studio runs on a different port. The CLI search command will call the configured LM Studio embedding endpoint to embed the query and return enriched metadata for each match. Use the `list` subcommand to quickly surface agregados whose municipality coverage exceeds the configured national threshold (`SIDRA_MUNICIPALITY_NATIONAL_THRESHOLD`, default 4000).
